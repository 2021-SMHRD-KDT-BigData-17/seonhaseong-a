<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.smhrd.PMnt.mapper.ProductMapper">
    
    <!-- 재고관리 sql -->
    <select id="productList" resultType="kr.smhrd.PMnt.entity.ProProduct">
       select * from pro_product order by preceivingdate desc
   </select>

   <!-- 재고관리  pnum 데이터 값 고정하여 넣는 sql문 -->
   <insert id= "productInsert" parameterType ="kr.smhrd.PMnt.entity.ProProduct">
		insert into pro_product (pnum, pname, preceivingquantity, pshipments, preceivingdate, pshippingdate, pexpirationdate, preceivingamount, pshippingamount, pincome, premarks, userbno)
		select pnum, #{pname},#{preceivingquantity},#{pshipments},#{preceivingdate},#{pshippingdate},pexpirationdate,#{preceivingamount},#{pshippingamount},#{pincome},#{premarks},#{userbno}
		from pro_productinfo
		where pname = #{pname}
		limit 1;
	</insert>
	
   <!-- 재고관리 삭제 sql문 -->
	<delete id = "productDelete" parameterType = "kr.smhrd.PMnt.entity.ProProduct">
       delete from pro_product where pseq=#{pseq}
   </delete>
   
	<!-- 제품명 검색기능 sql문 -->
	<select id = "productSearch" resultType = "kr.smhrd.PMnt.entity.ProProduct">
		select * from pro_product where pname = #{pname} and userbno = #{userbno}
	</select>
	
	<!-- 입고일 검색기능 sql문 -->
	<select id = "productSearch2" resultType = "kr.smhrd.PMnt.entity.ProProduct">
		select * from pro_product where preceivingdate = #{preceivingdate} and userbno = #{userbno}
	</select>
	
	<!-- 입고일 검색기능 sql문 -->
	<select id = "productSearch3" resultType = "kr.smhrd.PMnt.entity.ProProduct">
		select * from pro_product where pshippingdate = #{pshippingdate} and userbno = #{userbno}
	</select>
	
	<update id= "productUpdate" parameterType ="kr.smhrd.PMnt.entity.ProProduct">
		update pro_product set preceivingquantity = #{preceivingquantity},
		pshipments = #{pshipments}, preceivingdate = #{preceivingdate},
		pshippingdate =#{pshippingdate}, preceivingamount =#{preceivingamount},
		pshippingamount =#{pshippingamount},pincome = #{pincome}, premarks = #{premarks}
		where pseq=#{pseq} and userbno =#{userbno}
	</update>
	
	
	<select id="fruitsList" resultType="kr.smhrd.PMnt.entity.ProFruits">
       select * from pro_fruits where fmonth = date_format(now(), '%m');
   </select>
	
</mapper>